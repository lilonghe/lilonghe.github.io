<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="web 工程化"><meta name="keywords" content="web,gulp,js,"><link rel="alternate" href="/default" title="杂记"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1"><link rel="canonical" href="https://www.lilonghe.net/archives/web-build.html"><meta name="description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><meta property="og:type" content="article"><meta property="og:title" content="web 工程化"><meta property="og:url" content="https://www.lilonghe.net/archives/web-build.html"><meta property="og:site_name" content="杂记"><meta property="og:description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><meta property="og:updated_time" content="2017-03-28T13:44:01.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="web 工程化"><meta name="twitter:description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1"><link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"><script type="text/javascript">var themeConfig={fancybox:{enable:!1}}</script><title>web 工程化 - 杂记</title></head><body><div id="page"><header id="masthead"><div class="site-header-inner"><h1 class="site-title"><a href="/." class="logo">杂记</a></h1><nav id="nav-top"><ul id="menu-top" class="nav-top-items"><li class="menu-item"><a href="http://note.lilonghe.net/archives" target="_blank">Note</a></li><li class="menu-item"><a href="/archives">Archives</a></li><li class="menu-item"><a href="http://diary.lilonghe.net" target="_blank">Diary</a></li><li class="menu-item"><a href="/about">About</a></li></ul></nav></div></header><div id="content"><div id="primary"><article class="post"><header class="post-header"><h1 class="post-title">web 工程化</h1><time class="post-time">Oct 18 2016 - Mar 28 2017</time></header><div class="post-content"><h2 id="2017-3-2"><a href="#2017-3-2" class="headerlink" title="2017-3-2"></a>2017-3-2</h2><p>把现在项目用的基础架构打包了一下</p><h3 id="feture"><a href="#feture" class="headerlink" title="feture"></a>feture</h3><p>使用了<code>stylus</code>(换个口味吧…)<br><code>ES6</code>写的模块, <code>babel</code>编译成<code>amd</code>模块, 然后用<code>requirejs</code>加载</p><p>github: <a href="https://github.com/lilonghe/web-engineering-scaffolding" target="_blank" rel="external">https://github.com/lilonghe/web-engineering-scaffolding</a></p><hr><h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2><p><code>gulp-changed</code></p><blockquote><p>默认会更新所有匹配文件，用了这个瞬间轻松 &gt;_-</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">gulp.src([&apos;app/pages/**/*.html&apos;],&#123;base: &apos;./app/pages&apos;&#125;)</div><div class="line">    .pipe(changed(&apos;dist/&apos;))</div><div class="line">    xxxx ...</div><div class="line">        .pipe(gulp.dest(&apos;dist/&apos;));</div><div class="line">changed() 传递的路径要和 dest() 的路径一致</div><div class="line">技术思路是：对比源文件和输出文件的最后修改时间，后者小则通过</div></pre></td></tr></table></figure><p><code>gulp-wrap</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">gulp.src([&apos;app/pages/**/*.html&apos;],&#123;base: &apos;./app/pages&apos;&#125;)</div><div class="line">    .pipe(wrap(&#123;src:&quot;app/Master.html&quot;&#125;))</div><div class="line">        .pipe(gulp.dest(&apos;dist/&apos;));</div><div class="line">缺点是无法设置 title</div></pre></td></tr></table></figure><p></p><p><code>gulp-file-include</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.pipe(include(&#123;</div><div class="line">    prefix: &apos;@@&apos;,</div><div class="line">    basepath: &apos;./app/include/&apos;</div><div class="line">&#125;))</div><div class="line">@@include(&apos;header.html&apos;,&#123;</div><div class="line">    &quot;title&quot;:&quot;选课&quot;</div><div class="line">&#125;)</div><div class="line">这个可以自定义 title ，but 每个页面都要加~~~</div></pre></td></tr></table></figure><p></p><p><code>gulp-plumber</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var plumber_handler = &#123;</div><div class="line">    errorHandler: function(err) &#123;</div><div class="line">        console.log(err);</div><div class="line">        this.emit(&apos;end&apos;) </div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">gulp.src(&quot;app/static/css/*.scss&quot;)</div><div class="line">    .pipe(plumber(plumber_handler))</div><div class="line">示例是不传参的，但测试出现错误后无法继续运行</div></pre></td></tr></table></figure><p></p><p><code>gulp-sass</code> + <code>gulp-sourcemaps</code><br><code>gulp-babel</code></p><p><code>gulp-uglify</code><br><code>gulp-concat</code><br><code>gulp-clean</code></p><hr><p>东西一复杂，必然要找个解决方案。<br>资源可分为: JavaScript , CSS , Html , lib</p><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p><code>babel</code><br>每个复杂页面独占一个 JS， 然后入口页面写简单的 JS<br>然后利用 Gulp 打包</p><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p><code>gulp-sass</code><br>目前采用 sass ，简单编译，并没有标准模块化</p><h2 id="Html"><a href="#Html" class="headerlink" title="Html"></a>Html</h2><p><code>gulp-file-include</code><br>纯前端，所以页面不会压缩</p><h2 id="library"><a href="#library" class="headerlink" title="library"></a>library</h2><p>直接拷过去</p><hr><h3 id="本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！"><a href="#本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！" class="headerlink" title="本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！"></a>本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！</h3><p>因为自己也没进过大公司，不熟悉业界的标准，所以也是做着学着 ^_^<br>最近手上的这个项目 JS 也逐渐复杂了起来，所以就想着弄个模块开发试试吧~<br>然后大概弄了个基本骨架~~~<br>Github: aHR0cHM6Ly9naXRodWIuY29tL2xpbG9uZ2hlL2xpdHRsZS1jb2RlL3RyZWUvbWFzdGVyL3dlYi1lbmdpbmVlcmluZw==<br>先把这个放上来，等有空了把项目重构成模块化了再放上来一版 O_O</p><h2 id="JS-模块化工具"><a href="#JS-模块化工具" class="headerlink" title="JS 模块化工具"></a>JS 模块化工具</h2><p>选择 ES6 是因为它已经成为了标准，未来是它的<br>因为现在浏览器支持有限，所以涌现了大批工具<br>使用 ES6 规范写模块<br>使用 babel 编译 （preset-es2015）成 ES5 语法，但是，它使用了 require<br>因为 babel 没有直接转为浏览器可识别的语法<br>所以我们要使用 browserify 来打包转换它(打包原因估计是 ES5 没有文件引入)</p><h2 id="构建工具"><a href="#构建工具" class="headerlink" title="构建工具"></a>构建工具</h2><p>ok， Gulp 即可<br>PS: webpack 似乎有点复杂和庞大了</p><p>还有兼容性问题：<br>IE 8 对 Object.defineProperty 的支持有点问题<br>所以我们需要引入兼容文件<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!--[if lte IE 8]&gt;</div><div class="line">    https://github.com/inexorabletash/polyfill/blob/master/es5.js</div><div class="line">&lt;![endif]--&gt;</div></pre></td></tr></table></figure><p></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/web/">web</a> <a href="/tags/gulp/">gulp</a> <a href="/tags/js/">js</a></div><nav class="post-nav"><a class="prev" href="/archives/web-build-of-css.html"><i class="iconfont icon-left"></i> <span class="prev-text nav-default">Web 工程化之 CSS</span> <span class="prev-text nav-mobile">Prev</span> </a><a class="next" href="/archives/html5-video.html"><span class="next-text nav-default">Html5 Video</span> <span class="prev-text nav-mobile">Next</span> <i class="iconfont icon-right"></i></a></nav><div class="comments" id="comments"></div></footer></article></div></div><footer id="colophon"><span class="copyright-year">&copy; 2016 - 2017 <span class="footer-author">李龙贺.</span> <span class="power-by">Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a></span></span></footer></div></body></html>