<!DOCTYPE html><html class="light page-post"><head><meta charset="utf-8"><title>web 工程化 | 杂记</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="web,gulp,js,"><meta name="description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><meta name="keywords" content="web,gulp,js"><meta property="og:type" content="article"><meta property="og:title" content="web 工程化"><meta property="og:url" content="https://www.lilonghe.net/archives/web-build.html"><meta property="og:site_name" content="杂记"><meta property="og:description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><meta property="og:updated_time" content="2017-03-28T13:44:01.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="web 工程化"><meta name="twitter:description" content="2017-3-2把现在项目用的基础架构打包了一下feture使用了stylus(换个口味吧…)ES6写的模块, babel编译成amd模块, 然后用requirejs加载github: https://github.com/lilonghe/web-engineering-scaffoldingGulpgulp-changed默认会更新所有匹配文件，用了这个瞬间轻松 &amp;gt;_-123456gul"><link rel="icon" href="/favicon.ico"><link href="/css/styles.css?v=028c63b1" rel="stylesheet"><link rel="stylesheet" href="/css/personal-style.css"><script type="text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-69142286-1","auto"),ga("send","pageview")</script></head></html><body><span id="toolbox-mobile" class="toolbox-mobile">盒子</span><div class="post-header CENTER"><div class="toolbox"><a class="toolbox-entry" href="/"><span class="toolbox-entry-text">盒子</span> <i class="icon-angle-down"></i> <i class="icon-home"></i></a><ul class="list-toolbox"><li class="item-toolbox"><a class="CIRCLE" href="/archives/" target="_self">杂记</a></li><li class="item-toolbox"><a class="CIRCLE" href="/categories/" target="_self">分类</a></li><li class="item-toolbox"><a class="CIRCLE" href="/tags/" target="_self">标签</a></li><li class="item-toolbox"><a class="CIRCLE" href="/link/" target="_self">友链</a></li><li class="item-toolbox"><a class="CIRCLE" href="/about/" target="_self">关于</a></li></ul></div></div><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-3-2"><span class="toc-text">2017-3-2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#feture"><span class="toc-text">feture</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gulp"><span class="toc-text">Gulp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript"><span class="toc-text">JavaScript</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSS"><span class="toc-text">CSS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Html"><span class="toc-text">Html</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#library"><span class="toc-text">library</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！"><span class="toc-text">本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS-模块化工具"><span class="toc-text">JS 模块化工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#构建工具"><span class="toc-text">构建工具</span></a></li></ol></div><div class="content content-post CENTER"><article id="post-web-build" class="article article-type-post" itemprop="blogPost"><header class="article-header"><h1 class="post-title">web 工程化</h1><div class="article-meta"><span><i class="icon-calendar"></i> <span>2016.10.18</span> -> <span>2017.03.28</span> </span><span class="article-author"><i class="icon-user"></i> <span>李龙贺</span> </span><span class="article-category"><i class="icon-list"></i> <a class="article-category-link" href="/categories/uncompleted/">uncompleted</a></span></div></header><blockquote class="description"><small>本站禁止任何形式转载</small><br><small>欢迎邮件与我交流 <a href="mailto:lilonghe@outlook.com">lilonghe@outlook.com</a></small></blockquote><div class="article-content"><h2 id="2017-3-2"><a href="#2017-3-2" class="headerlink" title="2017-3-2"></a>2017-3-2</h2><p>把现在项目用的基础架构打包了一下</p><h3 id="feture"><a href="#feture" class="headerlink" title="feture"></a>feture</h3><p>使用了<code>stylus</code>(换个口味吧…)<br><code>ES6</code>写的模块, <code>babel</code>编译成<code>amd</code>模块, 然后用<code>requirejs</code>加载</p><p>github: <a href="https://github.com/lilonghe/web-engineering-scaffolding" target="_blank" rel="external">https://github.com/lilonghe/web-engineering-scaffolding</a></p><hr><h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2><p><code>gulp-changed</code></p><blockquote><p>默认会更新所有匹配文件，用了这个瞬间轻松 &gt;_-</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">gulp.src([&apos;app/pages/**/*.html&apos;],&#123;base: &apos;./app/pages&apos;&#125;)</div><div class="line">    .pipe(changed(&apos;dist/&apos;))</div><div class="line">    xxxx ...</div><div class="line">        .pipe(gulp.dest(&apos;dist/&apos;));</div><div class="line">changed() 传递的路径要和 dest() 的路径一致</div><div class="line">技术思路是：对比源文件和输出文件的最后修改时间，后者小则通过</div></pre></td></tr></table></figure><p><code>gulp-wrap</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">gulp.src([&apos;app/pages/**/*.html&apos;],&#123;base: &apos;./app/pages&apos;&#125;)</div><div class="line">    .pipe(wrap(&#123;src:&quot;app/Master.html&quot;&#125;))</div><div class="line">        .pipe(gulp.dest(&apos;dist/&apos;));</div><div class="line">缺点是无法设置 title</div></pre></td></tr></table></figure><p></p><p><code>gulp-file-include</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.pipe(include(&#123;</div><div class="line">    prefix: &apos;@@&apos;,</div><div class="line">    basepath: &apos;./app/include/&apos;</div><div class="line">&#125;))</div><div class="line">@@include(&apos;header.html&apos;,&#123;</div><div class="line">    &quot;title&quot;:&quot;选课&quot;</div><div class="line">&#125;)</div><div class="line">这个可以自定义 title ，but 每个页面都要加~~~</div></pre></td></tr></table></figure><p></p><p><code>gulp-plumber</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var plumber_handler = &#123;</div><div class="line">    errorHandler: function(err) &#123;</div><div class="line">        console.log(err);</div><div class="line">        this.emit(&apos;end&apos;) </div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">gulp.src(&quot;app/static/css/*.scss&quot;)</div><div class="line">    .pipe(plumber(plumber_handler))</div><div class="line">示例是不传参的，但测试出现错误后无法继续运行</div></pre></td></tr></table></figure><p></p><p><code>gulp-sass</code> + <code>gulp-sourcemaps</code><br><code>gulp-babel</code></p><p><code>gulp-uglify</code><br><code>gulp-concat</code><br><code>gulp-clean</code></p><hr><p>东西一复杂，必然要找个解决方案。<br>资源可分为: JavaScript , CSS , Html , lib</p><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p><code>babel</code><br>每个复杂页面独占一个 JS， 然后入口页面写简单的 JS<br>然后利用 Gulp 打包</p><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p><code>gulp-sass</code><br>目前采用 sass ，简单编译，并没有标准模块化</p><h2 id="Html"><a href="#Html" class="headerlink" title="Html"></a>Html</h2><p><code>gulp-file-include</code><br>纯前端，所以页面不会压缩</p><h2 id="library"><a href="#library" class="headerlink" title="library"></a>library</h2><p>直接拷过去</p><hr><h3 id="本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！"><a href="#本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！" class="headerlink" title="本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！"></a>本文皆是琢磨而来，小作坊式开发，未经过大型实战，敬请知悉哟！</h3><p>因为自己也没进过大公司，不熟悉业界的标准，所以也是做着学着 ^_^<br>最近手上的这个项目 JS 也逐渐复杂了起来，所以就想着弄个模块开发试试吧~<br>然后大概弄了个基本骨架~~~<br>Github: aHR0cHM6Ly9naXRodWIuY29tL2xpbG9uZ2hlL2xpdHRsZS1jb2RlL3RyZWUvbWFzdGVyL3dlYi1lbmdpbmVlcmluZw==<br>先把这个放上来，等有空了把项目重构成模块化了再放上来一版 O_O</p><h2 id="JS-模块化工具"><a href="#JS-模块化工具" class="headerlink" title="JS 模块化工具"></a>JS 模块化工具</h2><p>选择 ES6 是因为它已经成为了标准，未来是它的<br>因为现在浏览器支持有限，所以涌现了大批工具<br>使用 ES6 规范写模块<br>使用 babel 编译 （preset-es2015）成 ES5 语法，但是，它使用了 require<br>因为 babel 没有直接转为浏览器可识别的语法<br>所以我们要使用 browserify 来打包转换它(打包原因估计是 ES5 没有文件引入)</p><h2 id="构建工具"><a href="#构建工具" class="headerlink" title="构建工具"></a>构建工具</h2><p>ok， Gulp 即可<br>PS: webpack 似乎有点复杂和庞大了</p><p>还有兼容性问题：<br>IE 8 对 Object.defineProperty 的支持有点问题<br>所以我们需要引入兼容文件<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!--[if lte IE 8]&gt;</div><div class="line">    https://github.com/inexorabletash/polyfill/blob/master/es5.js</div><div class="line">&lt;![endif]--&gt;</div></pre></td></tr></table></figure><p></p></div><hr class="article-eof"></article></div><div class="text-center"><iframe class="donate-widget" src="/donate.html" frameborder="0" scrolling="no"></iframe></div><div class="footer-inner"><div class="copyright">&copy;<span itemprop="copyrightYear">2016</span> <span class="author" itemprop="copyrightHolder">李龙贺</span> <span class="cc-auth">本站所有作品均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC-BY-NC-SA</a>授权发布</span></div><div class="icp">皖ICP备16001167号</div><div class="ba"><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=34132202000116"><img src="/images/gwab-icon.png" style="display:inline-block;vertical-align:sub"> 皖公网安备 34132202000116号</a></div></div><a id="backTop" class="back-top"><i class="icon-angle-up"></i></a><div class="modal" id="modal"><span id="cover" class="cover hide"></span><div id="modal-dialog" class="modal-dialog hide-dialog"><div class="modal-header"><span id="close" class="btn-close">关闭</span></div><hr><div class="modal-body"><ul class="list-toolbox"><li class="item-toolbox"><a class="CIRCLE" href="/archives/" target="_self">杂记</a></li><li class="item-toolbox"><a class="CIRCLE" href="/categories/" target="_self">分类</a></li><li class="item-toolbox"><a class="CIRCLE" href="/tags/" target="_self">标签</a></li><li class="item-toolbox"><a class="CIRCLE" href="/link/" target="_self">友链</a></li><li class="item-toolbox"><a class="CIRCLE" href="/about/" target="_self">关于</a></li></ul></div></div></div><script type="text/javascript">function loadScript(e,t){var a=document.createElement("script");a.type="text/javascript",a.readyState?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,t())}:a.onload=function(){t()},a.src=e,document.getElementsByTagName("head")[0].appendChild(a)}window.onload=function(){loadScript("/js/bundle.js",function(){})}</script></body>